<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <title>Introduction</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
  <meta name="generator" content="PhD" />

  <link rel="start" href="index.html" title="PEAR Manual" />
  <link rel="up" href="package.fileformats.spreadsheet-excel-writer.html" title="Spreadsheet_Excel_Writer" />
  <link rel="prev" href="package.fileformats.spreadsheet-excel-writer.html" title="Spreadsheet_Excel_Writer" />
  <link rel="next" href="package.fileformats.spreadsheet-excel-writer.intro-format.html" title="Formatting Tutorial" />
 </head>
 <body>
<div class="navheader">
 <table style="width: 100%;">
  <tr><th colspan="3" style="text-align: center">Introduction</th></tr>
  <tr>
   <td style="width: 40%; text-align: left;"><a href="package.fileformats.spreadsheet-excel-writer.html" title="Spreadsheet_Excel_Writer">Prev</a></td>
   <td style="width: 20%;"></td>
   <td style="width: 40%; text-align: right;"><a href="package.fileformats.spreadsheet-excel-writer.intro-format.html" title="Formatting Tutorial">Next</a></td>
  </tr>
 </table>
 <hr/>
</div>
<div id="body">
<div class="refentry" id="package.fileformats.spreadsheet-excel-writer.intro">
   
    <h1 class="refname">Introduction</h1>
    <div class="refnamediv">Introduction &ndash; how to generate Excel files</div>

   

  <div class="refsection" id="package.fileformats.spreadsheet-excel-writer.intro.whatis"><div class="info"><h1>What is Spreadsheet_Excel_Writer?</h1>
</div>
   
   <p class="para">
    <strong class="classname">Spreadsheet_Excel_Writer</strong> is a tool for creating
    Excel files without the need for COM components. The files generated by
    the current version of <strong class="classname">Spreadsheet_Excel_Writer</strong>
    correspond to the Excel 5 (BIFF5) format, so all functionality until
    that version of Excel (but not beyond) should be available.
   </p>
  </div>

  <div class="refsection" id="package.fileformats.spreadsheet-excel-writer.intro.using-it"><div class="info"><h1>Using it</h1>
</div>
   
   <p class="para">
    The most common use for <strong class="classname">Spreadsheet_Excel_Writer</strong>
    will be spitting out large (or not so large) amounts of information
    in the form of a spreadsheet, which is easy to manipulate with a fairly
    ubiquitous spreadsheet program such as Excel (or OpenOffice).
   </p>
   <p class="para">
    So let&#039;s cut to the chase and see how this is done:
   </p>
   <div class="example"><div class="info"><p><strong>Typical usage</strong></p></div>
    
    <div class="phpcode">
<code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">require_once&nbsp;</span><span style="color: #DD0000">'Spreadsheet/Excel/Writer.php'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;Creating&nbsp;a&nbsp;workbook<br /></span><span style="color: #0000BB">$workbook&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Spreadsheet_Excel_Writer</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//&nbsp;sending&nbsp;HTTP&nbsp;headers<br /></span><span style="color: #0000BB">$workbook</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">send</span><span style="color: #007700">(</span><span style="color: #DD0000">'test.xls'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Creating&nbsp;a&nbsp;worksheet<br /></span><span style="color: #0000BB">$worksheet&nbsp;</span><span style="color: #007700">=&amp;&nbsp;</span><span style="color: #0000BB">$workbook</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addWorksheet</span><span style="color: #007700">(</span><span style="color: #DD0000">'My&nbsp;first&nbsp;worksheet'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;The&nbsp;actual&nbsp;data<br /></span><span style="color: #0000BB">$worksheet</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Name'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$worksheet</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Age'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$worksheet</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'John&nbsp;Smith'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$worksheet</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">30</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$worksheet</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Johann&nbsp;Schmidt'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$worksheet</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">31</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$worksheet</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Juan&nbsp;Herrera'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$worksheet</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">32</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Let's&nbsp;send&nbsp;the&nbsp;file<br /></span><span style="color: #0000BB">$workbook</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">close</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code>
    </div>
   </div>
   <p class="para">
   The first thing you should notice, is that we created a workbook before any
   worksheets. All worksheets are contained within a workbook, and a workbook
   may contain several worksheets.
   </p>
   <p class="para">
   Another important thing, which you should have in mind when programming
   with <strong class="classname">Spreadsheet_Excel_Writer</strong>, is that ampersand
   sign (&amp;) that appears when we created our worksheet. That ampersand means
   we are referencing a Worksheet object instead of copying it. If you don&#039;t
   know what that means, don&#039;t worry, all you have to remember is to always
   use ampersands when calling <a href="package.fileformats.spreadsheet-excel-writer.spreadsheet-excel-writer-workbook.addworksheet.html" class="link">
   <strong class="function">addWorksheet()</strong></a> for creating a worksheet, or
   <a href="package.fileformats.spreadsheet-excel-writer.spreadsheet-excel-writer-workbook.addformat.html" class="link"><strong class="function">addFormat()</strong></a> for creating a format.
   </p>
 </div>
 <div class="refsection" id="package.fileformats.spreadsheet-excel-writer.intro.saving-to-regular-file"><div class="info"><h1>Saving to a regular file</h1>
</div>
   
   <p class="para">
    You may have noticed also the following line:
    </p><div class="programlisting">
<br/>//&nbsp;sending&nbsp;HTTP&nbsp;headers<br/>$workbook-&gt;send(&#039;test.xls&#039;);
    </div><p>
    What that means is that we are sending our spreadsheet to a browser.
    But what if we just want to save the spreadsheet in our machine? Well, you
    just have to omit that line and give a valid file path to the workbook
    constructor.
   </p>
   <p class="para">
    For example, if we wanted to save the same spreadsheet we created in our
    first example to a file named &#039;test.xls&#039;, we would do it like so:
   </p>
   <div class="example"><div class="info"><p><strong>Saving to a regular file</strong></p></div>
    
    <div class="phpcode">
<code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">require_once&nbsp;</span><span style="color: #DD0000">'Spreadsheet/Excel/Writer.php'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;We&nbsp;give&nbsp;the&nbsp;path&nbsp;to&nbsp;our&nbsp;file&nbsp;here<br /></span><span style="color: #0000BB">$workbook&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Spreadsheet_Excel_Writer</span><span style="color: #007700">(</span><span style="color: #DD0000">'test.xls'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$worksheet&nbsp;</span><span style="color: #007700">=&amp;&nbsp;</span><span style="color: #0000BB">$workbook</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addWorksheet</span><span style="color: #007700">(</span><span style="color: #DD0000">'My&nbsp;first&nbsp;worksheet'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$worksheet</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Name'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$worksheet</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Age'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$worksheet</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'John&nbsp;Smith'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$worksheet</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">30</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$worksheet</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Johann&nbsp;Schmidt'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$worksheet</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">31</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$worksheet</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Juan&nbsp;Herrera'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$worksheet</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">32</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;We&nbsp;still&nbsp;need&nbsp;to&nbsp;explicitly&nbsp;close&nbsp;the&nbsp;workbook<br /></span><span style="color: #0000BB">$workbook</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">close</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>

  <div class="refsection" id="package.fileformats.spreadsheet-excel-writer.intro.more-tutorials"><div class="info"><h1>More tutorials</h1>
</div>
   
   <p class="para">
     If you would like to learn about formatting (fonts, cell color, text
     alignment, etc...) with <strong class="classname">Spreadsheet_Excel_Writer</strong>,
     you can check the formatting tutorial <a href="package.fileformats.spreadsheet-excel-writer.intro-format.html" class="link">
     here</a>.
   </p>
  </div>

</div>
</div>
<div class="navfooter">
 <hr />
 <table style="width: 100%;">
  <tr>
   <td style="width: 40%; text-align: left;"><a accesskey="p" href="package.fileformats.spreadsheet-excel-writer.html">Prev</a></td>
   <td style="width: 20%; text-align: center;"><a accesskey="h" href="package.fileformats.spreadsheet-excel-writer.html">Spreadsheet_Excel_Writer</a></td>
   <td style="width: 40%; text-align: right;"><a accesskey="n" href="package.fileformats.spreadsheet-excel-writer.intro-format.html">Next</a></td>
  </tr>
  <tr>
   <td style="text-align: left; vertical-align: top;">Spreadsheet_Excel_Writer</td>
   <td style="text-align: center;"><a accesskey="h" href="index.html">PEAR Manual</a></td>
   <td style="text-align: right; vertical-align: top;">Formatting Tutorial</td>
  </tr>
 </table>
</div>
</body></html>
