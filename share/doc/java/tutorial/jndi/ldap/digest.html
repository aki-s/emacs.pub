<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    

<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Digest-MD5 (The Java&trade; Tutorials &gt;        
            Java Naming and Directory Interface &gt; Advanced Topics for LDAP Users)
</title>

     <meta name="description" content="This JNDI Java tutorial describes Java Naming and Directory Interface (JNDI) technology, naming and directory operations, and LDAP" />
     <meta name="keywords" content="java programming, learn java, java sample code, jndi, ldap, jndi service provider" />
        
<style type="text/css">
    .FigureCaption   { 
        margin-left: 1in; 
        margin-right: 1in; 
        font-family: sans-serif; 
        font-size: smaller; 
        text-align: justify;
    }
    #TopBar_bl {
        background: url(../../images/java_bar_bl.gif) 0 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        background: url(../../images/java_bar_br.gif) 100% 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        background: url(../../images/java_bar_tl.gif) 0 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tr {
        background: url(../../images/java_bar_tr.gif) 100% 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar {
        background: #35556B url(../../images/java_bar.gif);
        margin: 10px 10px 0 10px;
        height:60px;
        min-width:700px;
        color: white;
        font-family: sans-serif; 
        font-weight: bold;
    }
    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    #TopBar_right {
        line-height: 14px;
        float: right;
        padding-top: 2px;
        padding-right: 30px;
        text-align: left;
    }
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 12px;
        margin: 3px;
        padding: 0;
    }
    #TopBar a:visited, #TopBar a:link {
        color: white;
        text-decoration: none;
    }
    #TopBar a:hover, #TopBar a:active  {
        background-color: white;
        color: #35556B;
    }
    #BreadCrumbs {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    #BreadCrumbs a {
        color: blue;
    }
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #F90000;
    }    
    #PageContent{
        margin: 0 5px 0 20px;
    }
    .LeftBar_shown {
        width: 13em;
        float: left;
        margin-left: 10px;
        margin-top: 4px;
        margin-bottom: 2em;
        margin-right: 10px;
    }
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    .LeftBar_hidden {
        display: none;
    }
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    
    .footertext {
        font-size: 10px;
        font-family: sans-serif; 
        margin-top: 1px;
    }
    
    #Footer2 {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    .NavBit  {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    @media print {
        .NavBit {
            display: none;
        }
    }
    #TagNotes {
        text-align: right;        
    }
    
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    #Contents a, .NavBit a, #TagNotes a {
        color: blue
    }
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #F90000;
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h1, h2, h3, h4, h5 {
        color: #F90000;
        font-family: sans-serif;
    }

    h1 {
        font-weight: bold;
        font-size: 20px;
    }

    h2 {
        font-weight: bold;
        font-size: 17px;
    }

    h3 {
        font-weight: bold;
        font-size: 14px;
    }

    h4 {
        font-size: 15px;
    }

    h5 {
        font-size: 12px;
    }


    #ToggleLeft {
        display: none;
    }
    
    .note {
        margin: 0 30px 0px 30px;
    }
    
    .codeblock {
        margin: 0 30px 0px 30px;
    }
    
    .tocli {
        list-style-type:none;
    }

    .betadraft {
        color: red;
    }
</style>
<script type="text/javascript">
/* <![CDATA[ */
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }

    function showCode(displayCodePage, codePath) {
        var codePathEls = codePath.split("/");
        var currDocPathEls = location.href.split("/");
        //alert ("codePathEls = " + codePathEls + "\n" + "currDocPathEls = " + currDocPathEls);
        currDocPathEls.pop(); // remove file name at the end
        while (codePathEls.length > 0) {
            if (codePathEls[0] == "..") {
                codePathEls.shift();
                currDocPathEls.pop();
            } else {
                break;
            }
        }
        var fullCodePath = currDocPathEls.join("/") + "/" + codePathEls.join("/");
        //alert ("fullCodePath = " + fullCodePath );
        if (codePath.indexOf(".java") != -1 || codePath.indexOf(".jnlp") != -1) {
            window.location.href = displayCodePage + "?code=" + encodeURI(fullCodePath);
        } else {
            window.location.href = fullCodePath;
        }
    }
/* ]]> */    
</script>


    </head>
<body onload="load()">
    <noscript>
        A browser with JavaScript enabled is required for this page to operate properly.
    </noscript>

    <div id="TopBar"> <div id="TopBar_tr"> <div id="TopBar_tl"> <div id="TopBar_br"> <div id="TopBar_bl"> 
                        <div id="TopBar_right"> 
                            <a target="_blank"
				href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">Download Ebooks</a><br />
                            <a target="_blank"
                                href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Download JDK</a>
                            <br />
                            <a href="../../search.html" target="_blank">Search Java Tutorials</a>
                            <br />
                            <a href="javascript:toggleLeft()"
                                id="ToggleLeft">Hide TOC</a>
                        </div>
                    </div> </div> </div> </div> </div>
    <div class="PrintHeaders">
        <b>Trail:</b> Java Naming and Directory Interface
        <br /><b>Lesson:</b> Advanced Topics for LDAP Users
        <br /><b>Section:</b> Security
    </div>

    <div id="LeftBar" class="LeftBar_shown">
        <div id="Contents">
            <div class="linkLESSON"><a href="index.html">Advanced Topics for LDAP Users</a></div>
<div class="linkAHEAD"><a href="ldap.html">LDAP v3</a></div>
<div class="linkAHEAD"><a href="jndi.html">JNDI as an LDAP API</a></div>
<div class="linkBHEAD"><a href="operations.html">How LDAP Operations Map to JNDI APIs</a></div>
<div class="linkBHEAD"><a href="exceptions.html">How LDAP Error Codes Map to JNDI Exceptions</a></div>
<div class="linkAHEAD"><a href="security.html">Security</a></div>
<div class="linkBHEAD"><a href="authentication.html">Modes of Authenticating to LDAP</a></div>
<div class="linkBHEAD"><a href="auth_mechs.html">Authentication Mechanisms</a></div>
<div class="linkBHEAD"><a href="anonymous.html">Anonymous</a></div>
<div class="linkBHEAD"><a href="simple.html">Simple</a></div>
<div class="linkBHEAD"><a href="sasl.html">SASL</a></div>
<div class="nolinkBHEAD">Digest-MD5</div>
<div class="linkBHEAD"><a href="ssl.html">SSL and Custom Sockets</a></div>
<div class="linkAHEAD"><a href="rename.html">More LDAP Operations</a></div>
<div class="linkBHEAD"><a href="compare.html">LDAP Compare</a></div>
<div class="linkBHEAD"><a href="result.html">Search Results</a></div>
<div class="linkBHEAD"><a href="unsol.html"> LDAP Unsolicited Notifications</a></div>
<div class="linkAHEAD"><a href="connect.html">Connection Management</a></div>
<div class="linkBHEAD"><a href="create.html">Creation</a></div>
<div class="linkBHEAD"><a href="close.html"> Closing</a></div>
<div class="linkBHEAD"><a href="pool.html">Pooling</a></div>
<div class="linkBHEAD"><a href="config.html">Configuration</a></div>
<div class="linkAHEAD"><a href="faq.html">Frequently Asked Questions</a></div>
</div>
    </div>
    <div id="MainFlow" class="MainFlow_indented">
            <span id="BreadCrumbs">
                <a href="../../index.html" target="_top">Home Page</a>
                &gt;
                <a href="../index.html" target="_top">Java Naming and Directory Interface</a>
                &gt;
                <a href="index.html" target="_top">Advanced Topics for LDAP Users</a>
            </span>
            <div class="NavBit">
                <a target="_top" href="sasl.html">&laquo;&nbsp;Previous</a>&nbsp;&bull;&nbsp;<a target="_top" href="../TOC.html">Trail</a>&nbsp;&bull;&nbsp;<a target="_top" href="ssl.html">Next&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle"><h1>Digest-MD5</h1></div>
            <div id="PageContent">

<p><em>Digest-MD5 authentication</em> is the required authentication mechanism for LDAP v3 servers (
<a class="OutsideLink" target="_blank" href="http://www.ietf.org/rfc/rfc2829.txt">RFC 2829</a>). Because the use of SASL is part of the LDAP v3 (
<a class="OutsideLink" target="_blank" href="http://www.ietf.org/rfc/rfc2251.txt">RFC 2251</a>), servers that support only the LDAP v2 do not support Digest-MD5.</p>
<p>The Digest-MD5 mechanism is described in 
<a class="OutsideLink" target="_blank" href="http://www.ietf.org/rfc/rfc2831.txt">RFC 2831</a>. It is based on the HTTP Digest Authentication (
<a class="OutsideLink" target="_blank" href="http://www.ietf.org/rfc/rfc2251.txt">RFC 2251</a>). In Digest-MD5, the LDAP server sends data that includes various authentication options that it is willing to support plus a special token to the LDAP client. The client responds by sending an encrypted response that indicates the authentication options that it has selected. The response is encrypted in such a way that proves that the client knows its password. The LDAP server then decrypts and verifies the client&#39;s response.</p>
<p>To use the Digest-MD5 authentication mechanism, you must set the authentication environment properties as follows.</p>
<dl>
<dt>
<a class="APILink" target="_blank" href="http://docs.oracle.com/javase/7/docs/api/javax/naming/Context.html#SECURITY_AUTHENTICATION"><tt>Context.SECURITY_AUTHENTICATION</tt></a>.</dt>
<dd>Set to the string <tt>&quot;DIGEST-MD5&quot;</tt>.</dd>
</dl>
<dl>
<dt>
<a class="APILink" target="_blank" href="http://docs.oracle.com/javase/7/docs/api/javax/naming/Context.html#SECURITY_PRINCIPAL"><tt>Context.SECURITY_PRINCIPAL</tt></a>.</dt>
<dd>Set to the principal name. This is a server-specific format. Some servers support a login user id format, such as that defined for Unix or Windows login screens. Others accept a distinguished name. Yet others use the authorization id formats defined in 
<a class="OutsideLink" target="_blank" href="http://www.ietf.org/rfc/rfc2829.txt">RFC 2829</a>. In that RFC, the name should be either the string <tt>&quot;dn:&quot;</tt>, followed by the fully qualified DN of the entity being authenticated, or the string <tt>&quot;u:&quot;</tt>, followed by the user id. Some servers accept multiple formats. Examples of some of these formats are <tt>&quot;cuser&quot;</tt>, <tt>&quot;dn: cn=C. User, ou=NewHires, o=JNDITutorial&quot;</tt>, and <tt>&quot;u: cuser&quot;</tt> The data type of this property must be <tt>java.lang.String</tt>.</dd>
</dl>
<dl>
<dt>
<a class="APILink" target="_blank" href="http://docs.oracle.com/javase/7/docs/api/javax/naming/Context.html#SECURITY_CREDENTIALS"><tt>Context.SECURITY_CREDENTIALS</tt></a>.</dt>
<dd>Set to the password of the principal (e.g., <tt>&quot;mysecret&quot;</tt>). It is of type <tt>java.lang.String</tt>, <tt>char</tt> array (<tt>char[]</tt>), or <tt>byte</tt> array (<tt>byte[]</tt>). If the password is a <tt>java.lang.String</tt> or <tt>char[]</tt>, then it is encoded by using UTF-8 for transmission to the server. If the password is a <tt>byte[]</tt>, then it is transmitted as is to the server.</dd>
</dl>
<p>The 
<a class="SourceLink" target="_blank" href="examples/Digest.java" onclick="showCode('../../displayCode.html', 'examples/Digest.java'); return false;"><code>following example</code></a> shows how a client performs authentication using Digest-MD5 to an LDAP server.</p>
<div class="codeblock"><pre>
// Set up the environment for creating the initial context
Hashtable&lt;String, Object&gt; env = new Hashtable&lt;String, Object&gt;();
env.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
env.put(Context.PROVIDER_URL, "ldap://localhost:389/o=JNDITutorial");

// Authenticate as C. User and password "mysecret"
env.put(Context.SECURITY_AUTHENTICATION, "DIGEST-MD5");
env.put(Context.SECURITY_PRINCIPAL, 
        "dn:cn=C. User, ou=NewHires, o=JNDITutorial");
env.put(Context.SECURITY_CREDENTIALS, "mysecret");

// Create the initial context
DirContext ctx = new InitialDirContext(env);

// ... do something useful with ctx
</pre></div>
<div class="note"><hr /><strong>Note:</strong>&nbsp;The 
<a class="OutsideLink" target="_blank" href="http://www.oracle.com/technetwork/testcontent/index-085178.html">Oracle Directory Server, v5.2</a> supports the Digest-MD5 authentication mechanism for users that have clear-text passwords. You must set the password encryption mode <em>before</em> you create the user. If you have already created the user, delete it and recreate it. To set the password encryption mode using the Administration Console, select the Configuration tab and the Data node. In the Passwords pane, select the &quot;No encryption (CLEAR)&quot; option for &quot;Password encryption.&quot; The server accepts simple user names (that is, the value of the <tt>&quot;uid&quot;</tt> attribute for entries that have one) and the &quot;dn:&quot; format of user names. See the server&#39;s documentation for detailed information.
<hr /></div>
<h2>Specifying the Realm</h2>
<p>A <em>realm</em> defines the namespace from which the authentication entity (the value of the <tt>Context.SECURITY_PRINCIPAL</tt> property) is selected. A server might have multiple realms. For example, a server for a university might be configured to have two realms, one for its student users and another for faculty users. Realm configuration is done by the directory administrator. Some directories have a default single realm. For example, the Oracle Directory Server, v5.2, uses the fully qualified hostname of the machine as the default realm.</p>
<p>In Digest-MD5 authentication, you must authenticate to a specific realm. You may use the following authentication environment property to specify the realm. If you do not specify a realm, then any one of the realms offered by the server will be used.</p>
<dl>
<dt><tt>java.naming.security.sasl.realm</tt></dt>
<dd>Set to the realm of the principal. This is a deployment-specific and/or server-specific case-sensitive string. It identifies the realm or domain from which the principal name (<tt>Context.SECURITY_PRINCIPAL</tt>) should be chosen. If this realm does not match one of the realms offered by the server, then the authentication fails.</dd>
</dl>
<p>The 
<a class="SourceLink" target="_blank" href="examples/DigestRealm.java" onclick="showCode('../../displayCode.html', 'examples/DigestRealm.java'); return false;"><code>following example</code></a> shows how to set the environment properties for performing authentication using Digest-MD5 and a specified realm. To make this example work in your environment, you must change the source code so that the realm value reflects what has been configured on your directory server.</p>
<div class="codeblock"><pre>
// Authenticate as C. User and password "mysecret" in realm "JNDITutorial"
env.put(Context.SECURITY_AUTHENTICATION, "DIGEST-MD5");
env.put(Context.SECURITY_PRINCIPAL, 
        "dn:cn=C. User, ou=NewHires, o=JNDITutorial");
env.put(Context.SECURITY_CREDENTIALS, "mysecret");
env.put("java.naming.security.sasl.realm", "JNDITutorial");
</pre></div>
<p>If you need to use 
<a class="OutsideLink" target="_blank" href="http://docs.oracle.com/javase/jndi/tutorial/ldap/security/digest.html">privacy protection</a> and other SASL properties, these are discussed in the JNDI Tutorial.</p>


        </div>
        <div class="NavBit">
            <a target="_top" href="sasl.html">&laquo; Previous</a>
            &bull;
            <a target="_top" href="../TOC.html">Trail</a>
            &bull;
            <a target="_top" href="ssl.html">Next &raquo;</a>
        </div>
    </div>
    <div id="Footer2">
<hr />
<div id="TagNotes">
    <p class="footertext">Problems with the examples? Try <a target="_blank"
        href="../../information/run-examples.html">Compiling and Running
        the Examples: FAQs</a>.
    <br />
    Complaints? Compliments? Suggestions? <a target="_blank"
        href="http://docs.oracle.com/javase/feedback.html">Give
    us your feedback</a>.
    </p>
</div> 

<div id="Footer">
<p class="footertext"><a name="license_info">Your use of this</a> page and all the material on pages under &quot;The Java Tutorials&quot; banner 
 is subject to these <a href="../../information/cpyr.html">legal notices</a>.
</p>
<table border="0" cellspacing="0" cellpadding="5" summary="">
    <tr>
         <td width="20%">
	 <table width="100%" border="0" cellspacing="0" cellpadding="5">
            <tr>
              <td headers="h1" align="center"><img id="duke" src="../../images/DukeWave.gif" width="55" height="55" alt="duke image" /></td>
              <td headers="h2" align="left" valign="middle"><img id="oracle" src="../../images/logo_oracle_footer.gif" width="100" height="29" alt="Oracle logo" /></td>
           </tr>
          </table>
          </td>

          <td width="55%" valign="middle" align="center">
		<p class="footertext"><a href="http://www.oracle.com/us/corporate/index.html">About Oracle</a> | <a href="http://www.oracle.com/technology/index.html">Oracle Technology Network</a> | <a href="http://www.oracle.com/us/legal/terms/index.html">Terms of Use</a></p> 
	 </td>
          <td width="25%" valign="middle" align="right">
      		<p class="footertext">Copyright &copy; 1995, 2013 Oracle and/or its affiliates. All rights reserved.</p>
	 </td>
     </tr>     
</table>
</div>
    </div>
    <div class="PrintHeaders">
        <b>Previous page:</b> SASL
        <br /><b>Next page:</b> SSL and Custom Sockets
    </div>
</body>
</html> 
